## 密码学  

2022.03.01  
2022.03.22
- 国际密码安全协会  
- <handbook of applied cryptography>  
- <Encyclopedia of cryptography and security>  
    
### 导论  
- 整数因式分解困难和哈希函数不存在冲突
- 模运算  
- cryptology，编码学，cryptography，密码学  
- 密码使用学：
    - 对称算法，Symmetric Alg  
    - 非对称算法，Asymmetric Alg  
    - 密码协议，例如TLS  
- 对称  
- 替换  
- 蛮力攻击总是可以破解对称  
- 字母频率分析  
- 模运算  
- 基于有限个元素的运算  
- 12三3mod9
- 等价类，中的成员行为等价  
- x^e mod m  
- 模简约  
- 整数环  
- 封闭环  
- 逆元，a·a^-1三mod m  
- gcd，Greatest Common Divisior，a存在乘法逆元：gcd（a,m）=1  
- 互素，互质  
- 仿射密码，明文乘秘钥的一部分加秘钥剩余部分a*x+bmod26；x三a^-1*(y-b)  
- 秘钥空间，aXb  
- 
### 序列密码  
- 对称密码：分组和序列  
    - mod2加和XOR等价  
    - XOR均衡，可逆  
    - 随机数生成器：RNG，random numeral generator：TRNG，PRNG，CSPRNG  
    - 无条件安全  
    - OTP，one time pad  
 
### 数据加密标准与替换算法  
    
    
- end


### 数据加密标准和替换算法  

- NSA小组和IBM领先学术界15年  
- DES，data Encrypted strand   
- 密码长度128->56 
- 3DES  
- FIPS PUB 46  
- AES，advance Encry strand  
- 混淆，Confusion，秘钥和密文模糊  
- 扩散，Diffusion，明文扩散到多个密文，隐藏明文的统计属性  
- DES，使用56位秘钥对64位长分组进行加密  
- Feistel网络  
- 差分密码分析  
- S-盒，非线性  
- 攻击：穷尽秘钥搜索，分析攻击  
- 查分密码分析DC  
- 线性攻击分析LC  

- 轻量级密码PRESENT  

### 高级加密标准  
- 一些标准：AES，IPsec、TLS、802.11i、SSH  
- NIST，国家标准与技术研究院  
- Rijndael  
- 层：字节代换层（s-盒），shiftRows层，MixColumn层，秘钥加密层  
- GF，GF（2）  
- AES,面向字节的密码  
- 吞吐率50Mb/s  

### 分组密码 

- 操作模式  
- 加密和身份认证  
- ECB  
- CBC  
- CFB  
- OFB  
- CTR  
- 流量分析，  
- MAC，消息验证码和数字签名  
- 概率加密  
- IV，初始向量  

### 公钥密码  

- 数论函数  
- 对称：加解密使用相同的秘钥，加解密函数类似  
- 问题：秘钥分配问题，秘钥个数，防御机制（不可否认性）  
- 单向函数：整数分解RSA，离散对数DSA，椭圆曲线EC方案  
- 公钥算法的安全机制：秘钥建立，不可否认性，身份标识，加密  
- 缺点：速度慢，数据加密一般不用  
- 证书  
- n位的安全等级：最好的攻击需要2^n  
- 计算复杂度是位增长的三次方  
- 欧几里得算法：gcd（r0,r1）=gcd（r0-r1,r1）  
- 模逆元  
- 欧拉函数，得知道m的因式分解  
- 费马小定理a^p 三 a(mod P)；a^p-1三1（mod p）    
- 欧拉定理：a^φm三1（modm）  

### RSA密码体制  

- Whilefiled Diffie Martin Hellman   
~~~
加密：y三x^e mod n  
解密：x=d（y）三 y^d mod n   
~~~
- RSA秘钥生成  
~~~
输出：公钥k=（n，e）；私钥：k=（d）  
1. 选择素数p、q  
2. 计算n=p*q  
3. φn = （p-1）*（q-1）  
4. 选择e∈{1,2，...，φn-1}，满足gcd（e,φn）=1  
5. 计算私钥d：d*e 三 1modφn
~~~  
- 快速指数运算：平方-乘算法  
- 寻找最大素数，理论：整数p是素数的概率1/ln(p)  

### 离散对数问题  

- DLP，Discrete Logarithm Problem  
- Diffie-Hellman交换：k=（α^x）^y≡（α^y）^x mod p  
- 
~~~
D-H握手协议：
1.选择大素数p，
2.选择整数α∈{2,3，...p-2}
3.公开p，α
~~~
~~~
D-H秘钥交换  
1.α∈{2,3，...p-2}
2.计算A=kpub，a≡α^a mod p
3.交出A,获得B  
4.KAB=B^a mod p;
~~~
- 群：一个元素的集合G以及联合G内两个元素的操作o的集合。  
- Zn*：由i=0,1，...，n-1；满足gcd（i，n）=1的元素与乘法模n操作形成了阿贝尔群（可交换群），且单位元e=1  
- n=9，{1,2,4,5,7,8}  
- 有限群（G,o） 基，阶|G|  
- 元素的阶，ord（a）：满足以下条件的最小正整数：a^k=aoaoao...oa=1  
- 循环群：如果群G包含一个拥有最大阶ord（α）=|G|的元素α，  
- 生成元α。 α^i=a,G中每个元素a都可以写成这个元素的幂值，即α产生了整个群。   
- 定理：素数p，Zp* 都是一个阿贝尔有限循环群。  
- 子群  
- 离散对数问题：生成元α和另一个元素β；确定x，α^x ≡ βmodp  
- x称为以α为基的β的离散对数 x=logα （β）modp  
- 中间人攻击  
- Elgamal加密方案  

### 椭圆曲线密码体制  

- ECC  
- 多项式方程  
~~~
y^2 ≡ x^3+ax+bmodp  
并且满足4a^3+27b^2≠0modp  
~~~
- 曲线非奇异，不会自我相交或没有顶点。  
- 群加法  
- 单位元，中性元，  
- 逆元，x轴对称的点  
- 阶  
- Hasses定理，阶的范围  
- P+P+P+P=dP=T，点乘  

### 数字签名  

- 对称密码的局限性，不能证明某一个加密文件是某一方生产，双方都有公钥对  
- 握手阶段是完全对称的  
- 公钥算法，握手的不对称性  
~~~
公钥，kpub
私钥加密x，s  
公钥验证kpub（x，s）是否为真  
~~~
- 区别数字签名使用私钥签名，公钥验证  
- RSA填充技术：对消息格式化，区分有效消息和无效消息  

### 哈希函数  

- 定义：是一个信息的摘要，非常短，固定长度的位字符串  
- 对长消息签名，  
- RSA中消息不能比模数大，否则，需要分组  
- 函数h的计算必须是高效的  
- 3个安全问题：1.抗第一原像性，2.抗第二原像性，3.抗冲突性 
- 所有的输出都可能存在弱冲突，鸽巢原理   
- 生日悖论：23-50%；40-90%  
- 攻击，80位，检查2^40个消息够了  
- 攻击：数学冲突攻击  
- 一般是长度的一半  
- 2中通用类型  
  - 专用的哈希函数  
  - 基于分组密码的哈希函数  
- 核心：压缩，Merkle-Damgard结构  
- 专用：MD4家族：MD5，SHA，RIPEMD  
- 输出128位  
- SHA，安全hash算法，SHA-0,SHA-1，160位
- 王小云-冲突查找攻击，2^63位远小于80位  
-   

### 秘钥建立  

- 保密性  
- 完整性  
- 消息验证  
- 不可否认性  
- 秘钥建立和秘钥传输  
- 秘钥刷新，会话秘钥，临时秘钥  
- 衍生秘钥，单向函数  
- 多遍生成  
 
- 证书：身份标识与公钥进行绑定  
- CA，可信的第三方发布，为系统中的用户生成和颁发证书  
-   
-   
- 

- end
